<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 Controlling the familywise error rate | Assignments: Inference for High Dimensional Data</title>
  <meta name="description" content="Assignment problems for the course Inference for High Dimensional Data in M.Stat 2nd year, 2019-2020, at Indian Statistical Institute, Kolkata." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 Controlling the familywise error rate | Assignments: Inference for High Dimensional Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Assignment problems for the course Inference for High Dimensional Data in M.Stat 2nd year, 2019-2020, at Indian Statistical Institute, Kolkata." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 Controlling the familywise error rate | Assignments: Inference for High Dimensional Data" />
  
  <meta name="twitter:description" content="Assignment problems for the course Inference for High Dimensional Data in M.Stat 2nd year, 2019-2020, at Indian Statistical Institute, Kolkata." />
  

<meta name="author" content="Joydeep Chowdhury" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multipletesting.html"/>
<link rel="next" href="FDR.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Assignments: Inference for High Dimensional Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="regularizations.html"><a href="regularizations.html"><i class="fa fa-check"></i><b>1</b> Regularized regression</a><ul>
<li class="chapter" data-level="1.1" data-path="regularizations-description.html"><a href="regularizations-description.html"><i class="fa fa-check"></i><b>1.1</b> Lasso and other regularizations</a><ul>
<li class="chapter" data-level="1.1.1" data-path="regularizations-description.html"><a href="regularizations-description.html#lasso-description"><i class="fa fa-check"></i><b>1.1.1</b> Lasso</a></li>
<li class="chapter" data-level="1.1.2" data-path="regularizations-description.html"><a href="regularizations-description.html#ridge-description"><i class="fa fa-check"></i><b>1.1.2</b> Ridge regression</a></li>
<li class="chapter" data-level="1.1.3" data-path="regularizations-description.html"><a href="regularizations-description.html#elasticnet-description"><i class="fa fa-check"></i><b>1.1.3</b> Elastic net</a></li>
<li class="chapter" data-level="1.1.4" data-path="regularizations-description.html"><a href="regularizations-description.html#adaptivelasso-description"><i class="fa fa-check"></i><b>1.1.4</b> Adaptive lasso</a></li>
<li class="chapter" data-level="1.1.5" data-path="regularizations-description.html"><a href="regularizations-description.html#grouplasso-description"><i class="fa fa-check"></i><b>1.1.5</b> Group lasso</a></li>
<li class="chapter" data-level="1.1.6" data-path="regularizations-description.html"><a href="regularizations-description.html#fusedlasso-description"><i class="fa fa-check"></i><b>1.1.6</b> Fused lasso</a></li>
<li class="chapter" data-level="1.1.7" data-path="regularizations-description.html"><a href="regularizations-description.html#otherregularizations-description"><i class="fa fa-check"></i><b>1.1.7</b> Other regularizations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html"><i class="fa fa-check"></i><b>1.2</b> Numerical demonstration</a><ul>
<li class="chapter" data-level="1.2.1" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#lasso-computation"><i class="fa fa-check"></i><b>1.2.1</b> Lasso computation</a></li>
<li class="chapter" data-level="1.2.2" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#ridge-computation"><i class="fa fa-check"></i><b>1.2.2</b> Ridge regression computation</a></li>
<li class="chapter" data-level="1.2.3" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#elasticnet-computation"><i class="fa fa-check"></i><b>1.2.3</b> Elastic net computation</a></li>
<li class="chapter" data-level="1.2.4" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#adaptivelasso-computation"><i class="fa fa-check"></i><b>1.2.4</b> Adaptive lasso computation</a></li>
<li class="chapter" data-level="1.2.5" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#grouplasso-computation"><i class="fa fa-check"></i><b>1.2.5</b> Group lasso computation</a></li>
<li class="chapter" data-level="1.2.6" data-path="regularizations-demonstration.html"><a href="regularizations-demonstration.html#fusedlasso-computation"><i class="fa fa-check"></i><b>1.2.6</b> Fused lasso computation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multipletesting.html"><a href="multipletesting.html"><i class="fa fa-check"></i><b>2</b> Multiple testing</a><ul>
<li class="chapter" data-level="2.1" data-path="FWER.html"><a href="FWER.html"><i class="fa fa-check"></i><b>2.1</b> Controlling the familywise error rate</a><ul>
<li class="chapter" data-level="2.1.1" data-path="FWER.html"><a href="FWER.html#bonferroni"><i class="fa fa-check"></i><b>2.1.1</b> Bonferroni correction</a></li>
<li class="chapter" data-level="2.1.2" data-path="FWER.html"><a href="FWER.html#holm"><i class="fa fa-check"></i><b>2.1.2</b> Holm’s method</a></li>
<li class="chapter" data-level="2.1.3" data-path="FWER.html"><a href="FWER.html#hochberg"><i class="fa fa-check"></i><b>2.1.3</b> Hochberg’s method</a></li>
<li class="chapter" data-level="2.1.4" data-path="FWER.html"><a href="FWER.html#hommel"><i class="fa fa-check"></i><b>2.1.4</b> Hommel’s method</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="FDR.html"><a href="FDR.html"><i class="fa fa-check"></i><b>2.2</b> False discovery rate and its control</a><ul>
<li class="chapter" data-level="2.2.1" data-path="FDR.html"><a href="FDR.html#BH"><i class="fa fa-check"></i><b>2.2.1</b> Benjamini-Hochberg method</a></li>
<li class="chapter" data-level="2.2.2" data-path="FDR.html"><a href="FDR.html#BY"><i class="fa fa-check"></i><b>2.2.2</b> Benjamini–Yekutieli method</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="adjusted-pvalues.html"><a href="adjusted-pvalues.html"><i class="fa fa-check"></i><b>2.3</b> Adjusted p-values</a></li>
<li class="chapter" data-level="2.4" data-path="multipletesting-summary.html"><a href="multipletesting-summary.html"><i class="fa fa-check"></i><b>2.4</b> Summary</a></li>
<li class="chapter" data-level="2.5" data-path="multipletesting-demonstration.html"><a href="multipletesting-demonstration.html"><i class="fa fa-check"></i><b>2.5</b> Numerical demonstration</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="assignments.html"><a href="assignments.html"><i class="fa fa-check"></i><b>3</b> Assignments</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Assignments: Inference for High Dimensional Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="FWER" class="section level2">
<h2><span class="header-section-number">2.1</span> Controlling the familywise error rate</h2>
<p>Since <span class="math inline">\(P[ V \ge 1 ]\)</span> is the probability of rejecting at least one true null hypothesis, by ensuring <span class="math inline">\(P[ V \ge 1 ] \le \alpha\)</span>, we bound the maximum familywise error rate by <span class="math inline">\(\alpha\)</span>. Below, several methods to achieve this are described.</p>
<div id="bonferroni" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Bonferroni correction</h3>
<p>Suppose the level of each of the <span class="math inline">\(m\)</span> hypotheses <span class="math inline">\(H_1, \ldots, H_m\)</span> is <span class="math inline">\(\beta\)</span>. From the <a href="https://en.wikipedia.org/wiki/Boole%27s_inequality">Boole’s inequality</a>, we have <span class="math inline">\(P[ V \ge 1 ] = P\left[ \cup_{i=1}^{m} \{H_i \text{ is rejected while being true}\} \right] \le \sum_{i=1}^{m} P[H_i \text{ is rejected while being true}] = m \beta\)</span>. Therefore, to ensure FWER <span class="math inline">\(\le \alpha\)</span>, we take the level of each of the individual hypotheses as <span class="math inline">\(\alpha / m\)</span>.</p>
<p>The Bonferroni correction is very conservative in nature (has a high type II error), as the level of each of the individual tests is very low for even moderate <span class="math inline">\(p\)</span>. Also, when the test statistics for the hypotheses are not independent, which is often the case for high dimensional setup, the actual FWER corresponding to the Bonferroni correction is considerably lower than <span class="math inline">\(\alpha\)</span>. This can be understood from the fact that <span class="math inline">\(P[A \cup B] = P[A] + P[B] - P[A \cap B]\)</span>, which implies that for <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> being dependent events, <span class="math inline">\(P[A \cup B] &lt; P[A] + P[B]\)</span>.</p>
<p>Several methods were developed subsequently to mitigate the conservative nature of the Bonferroni correction. These are based on the principle of rejecting the hypotheses with the lowest p-values only, and accepting the rest.</p>
</div>
<div id="holm" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Holm’s method</h3>
<p>The Holm’s method, developed by <span class="citation">Holm (<a href="#ref-holm1979simple">1979</a>)</span>, first orders the p-values <span class="math inline">\(P_1, \ldots, P_m\)</span> corresponding to the <span class="math inline">\(m\)</span> hypotheses <span class="math inline">\(H_1, \ldots, H_m\)</span> in the increasing order. Let the ordered p-values be <span class="math inline">\(P_{(1)}, \ldots, P_{(m)}\)</span>, and the corresponding hypotheses be <span class="math inline">\(H_{(1)}, \ldots, H_{(m)}\)</span>. For a given level <span class="math inline">\(\alpha\)</span>, let <span class="math inline">\(k\)</span> be the smallest integer such that <span class="math display">\[P_{(k)} &gt; \frac{\alpha}{m - k + 1}.\]</span> The Holm’s method rejects the hypotheses <span class="math inline">\(H_{(1)}, \ldots, H_{(k-1)}\)</span>, and does not reject <span class="math inline">\(H_{(k)}, \ldots, H_{(m)}\)</span>. If <span class="math inline">\(k = 1\)</span>, it does not reject any null hypotheses, and if no such <span class="math inline">\(k\)</span> exists, it rejects all the null hypotheses.</p>
<p>It is easy to see that, whenever the Bonferroni correction rejects a particular hypothesis, the Holm’s method also rejects it, but not the contrary. It can be proved that FWER <span class="math inline">\(\le \alpha\)</span> for the Holm’s method. Hence, the Holm’s method is uniformly more powerful than the Bonferroni correction.</p>
</div>
<div id="hochberg" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Hochberg’s method</h3>
<p>Hochberg’s method <span class="citation">(Hochberg <a href="#ref-hochberg1988sharper">1988</a>)</span> also orders the p-values in the increasing order as in <a href="FWER.html#holm">2.1.2</a>. However, it finds the largest integer <span class="math inline">\(k\)</span> such that <span class="math display">\[P_{(k)} \le \frac{\alpha}{m - k + 1},\]</span> and then rejects <span class="math inline">\(H_{(1)}, \ldots, H_{(k)}\)</span> but does not reject <span class="math inline">\(H_{(k+1)}, \ldots, H_{(m)}\)</span>.</p>
<p>At the first glance, the Holm’s method and the Hochberg’s method may seem identical, but in fact Hochberg’s method is uniformly more powerful than the former. This is due to the fact that the Hochberg’s method rejects <span class="math inline">\(H_{(1)}, \ldots, H_{(k)}\)</span> whenever the Holm’s method rejects them, but not the other way. Intuitively, because the Hochberg’s method considers the p-values from the highest to the lowest, it is always inclined to reject more hypotheses than the Holm’s method.
However, unlike the Holm’s method, whose bound on FWER does not need any assumption on the underlying distribution or dependence among the p-values or test statistics, the Hochberg’s method does (<span class="citation">Sarkar and Chang (<a href="#ref-sarkar1997simes">1997</a>)</span>, <span class="citation">Sarkar (<a href="#ref-sarkar1998some">1998</a>)</span>). Its bound on FWER is valid in particular when the test statistics for the individual hupotheses are indepdendent or positively correlated.</p>
</div>
<div id="hommel" class="section level3">
<h3><span class="header-section-number">2.1.4</span> Hommel’s method</h3>
<p>In the Hommel’s method <span class="citation">(Hommel <a href="#ref-hommel1988stagewise">1988</a>)</span>, one again orders the p-values as in <a href="FWER.html#holm">2.1.2</a>, then finds the maximum integer <span class="math inline">\(j\)</span> in <span class="math inline">\(1, \ldots, n\)</span> such that <span class="math display">\[P_{(n - j + k)} &gt; \frac{k \alpha}{j}\]</span> for all <span class="math inline">\(k = 1, \ldots, j\)</span>. If such a maximum <span class="math inline">\(j\)</span> does not exist, one rejects all the null hypotheses <span class="math inline">\(H_i\)</span>, <span class="math inline">\(i = 1, \ldots, m\)</span>. Otherwise, one rejects the hypotheses whose corresponding p-values satisfy <span class="math inline">\(P_i \le \alpha / j\)</span>.</p>
<p>It can be shown that the Hommel’s method is more powerful than the Hochberg’s method. However, the validity of the bound on its FWER also requires certain assumptions.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-hochberg1988sharper">
<p>Hochberg, Yosef. 1988. “A Sharper Bonferroni Procedure for Multiple Tests of Significance.” <em>Biometrika</em> 75 (4): 800–802.</p>
</div>
<div id="ref-holm1979simple">
<p>Holm, Sture. 1979. “A Simple Sequentially Rejective Multiple Test Procedure.” <em>Scandinavian Journal of Statistics</em>, 65–70.</p>
</div>
<div id="ref-hommel1988stagewise">
<p>Hommel, Gerhard. 1988. “A Stagewise Rejective Multiple Test Procedure Based on a Modified Bonferroni Test.” <em>Biometrika</em> 75 (2): 383–86.</p>
</div>
<div id="ref-sarkar1998some">
<p>Sarkar, Sanat K. 1998. “Some Probability Inequalities for Ordered Mtp2 Random Variables: A Proof of the Simes Conjecture.” <em>Annals of Statistics</em>, 494–504.</p>
</div>
<div id="ref-sarkar1997simes">
<p>Sarkar, Sanat K, and Chung-Kuei Chang. 1997. “The Simes Method for Multiple Hypothesis Testing with Positively Dependent Test Statistics.” <em>Journal of the American Statistical Association</em> 92 (440): 1601–8.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multipletesting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="FDR.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["High-Dimensional-Data-assignments.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
